name: Verify Required Secrets

on:
  pull_request:
    types: [opened, synchronize, reopened]
  workflow_dispatch:

jobs:
  verify-secrets:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Verify QUAY_PASSWORD Token Secret
        env:
          QUAY_PASSWORD: ${{ secrets.QUAY_PASSWORD }}
        run: |
          echo "Checking for required secrets..."
          
          if [ -z "$QUAY_PASSWORD" ]; then
            echo "❌ ERROR: QUAY_PASSWORD secret is not set or is empty"
            echo "Please ensure the QUAY_PASSWORD secret is configured in the repository settings."
            echo "Go to: Settings > Secrets and variables > Actions > Repository secrets"
            exit 1
          else
            echo "✅ SUCCESS: QUAY_PASSWORD secret is present"
            echo "Secret length: ${#QUAY_PASSWORD} characters"
          fi

      - name: Summary
        if: success()
        run: |
          echo "🎉 All required secrets are properly configured!"
          echo "This pull request can proceed with the confidence that required secrets are available."
